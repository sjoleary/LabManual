<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="11 Species distribution modeling | Lab Manual Conservation Biology Fall 2020" />
<meta property="og:type" content="book" />





<meta name="author" content="Shannon J. O’Leary" />

<meta name="date" content="2020-11-11" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="11 Species distribution modeling | Lab Manual Conservation Biology Fall 2020">

<title>11 Species distribution modeling | Lab Manual Conservation Biology Fall 2020</title>

<link href="libs/tufte-css/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css/msmb.css" rel="stylesheet" />
<script src="libs/accessible-code-block/empty-anchor.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="msmb.css" type="text/css" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Lab Manual Conservation Biology Fall 2020<p><p class="author">Shannon J. O'Leary</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Overview</a>
<a href="installing-rrstudio.html"><span class="toc-section-number">1</span> Installing R/Rstudio</a>
<a href="project-management-and-rmarkdown-basics.html"><span class="toc-section-number">2</span> Project management and Rmarkdown Basics</a>
<a href="welcome-to-the-tidyverse.html"><span class="toc-section-number">3</span> Welcome to the tidyverse</a>
<a href="field-stream-trip.html"><span class="toc-section-number">4</span> Field &amp; Stream Trip</a>
<a href="assessing-sources-calling-bullsht.html"><span class="toc-section-number">5</span> Assessing sources &amp; calling bullsh*t</a>
<a href="island-biogeography.html"><span class="toc-section-number">6</span> Island Biogeography</a>
<a href="iucn-redlist-evaluation.html"><span class="toc-section-number">7</span> IUCN Redlist Evaluation</a>
<a href="stream-diversity.html"><span class="toc-section-number">8</span> Stream Diversity</a>
<a href="habitat-fragmentation.html"><span class="toc-section-number">9</span> Habitat Fragmentation</a>
<a href="biomagnification.html"><span class="toc-section-number">10</span> Biomagnification</a>
<a id="active-page" href="species-distribution-modeling.html"><span class="toc-section-number">11</span> Species distribution modeling</a><ul class="toc-sections">
<li class="toc"><a href="#species-distribution-modeling-1"> Species distribution modeling</a></li>
<li class="toc"><a href="#get-occurrence-data"> Get occurrence data</a></li>
<li class="toc"><a href="#get-environmental-data"> Get environmental data</a></li>
<li class="toc"><a href="#create-species-distribution-model"> Create species distribution model</a></li>
<li class="toc"><a href="#future-climate-change"> Future climate change</a></li>
<li class="toc"><a href="#NA"> Shifting distributions impact species interactions.</a></li>
<li class="toc"><a href="#acknowledgments"> Acknowledgments</a></li>
</ul>
<a href="shark-fin-trade-monitoring.html"><span class="toc-section-number">12</span> Shark fin trade monitoring</a>
<a href="population-modeling.html"><span class="toc-section-number">13</span> Population modeling</a>
<a href="stochastic-genetic-effects.html"><span class="toc-section-number">14</span> Stochastic Genetic Effects</a>
<a href="references.html">References</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="species-distribution-modeling" class="section level1">
<h1>
<span class="header-section-number">11</span> Species distribution modeling</h1>
<p><strong>Date</strong>: 10/7/2020</p>
<p>Download the project folder <a href="https://drive.google.com/drive/folders/1SQHRRyfk_XhX4jb1PD9MY0ndQKDoW_I9?usp=sharing">here</a>.</p>
<p>Make sure to download the <strong>entire</strong> folder (not just the contents).</p>
<p>You can open the <code>Rproject</code> directly by double-clicking on the file which will launch <code>Rstudio</code>, or once you have opened <code>Rstudio</code> open the project folder using <code>File -&gt; Open Project</code> or using the <code>Rproj</code> icon in the top right corner above the environment panel.</p>
<p><strong>Learning Objectives</strong></p>
<p>After completing this lab you should</p>
<ul>
<li>be able to visualize and describe spatial patterns in occurrence data of a given species.</li>
<li>understand the information contained climate/bioclim data sets and how they can be used to build species distribution models.</li>
<li>understand how the <code>bioclim</code> algorithm fits species occurrence records.</li>
<li>understand the difference between presence-only and presence-absence SDMs and their strengths &amp; limitations.</li>
<li>be able to explain how shifts in geographic ranges may result in a population asynchrony.</li>
</ul>
<p><br></p>
<p><strong>Before we start</strong></p>
<p>There are several packages that need to be downloaded and installed before we can run this analysis<label for="tufte-sn-50" class="margin-toggle sidenote-number">50</label><input type="checkbox" id="tufte-sn-50" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">50</span> Remember, you only need to install them once - but any time you restart your <code>R session</code> e.g. by restarting <code>Rstudio</code> you need to make sure to run the code that loads the libraries.</span>.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="species-distribution-modeling.html#cb158-1"></a><span class="co"># install libraries</span></span>
<span id="cb158-2"><a href="species-distribution-modeling.html#cb158-2"></a><span class="kw">install.packages</span>(<span class="st">"sp"</span>)</span>
<span id="cb158-3"><a href="species-distribution-modeling.html#cb158-3"></a><span class="kw">install.packages</span>(<span class="st">"raster"</span>)</span>
<span id="cb158-4"><a href="species-distribution-modeling.html#cb158-4"></a><span class="kw">install.packages</span>(<span class="st">"maptools"</span>)</span>
<span id="cb158-5"><a href="species-distribution-modeling.html#cb158-5"></a><span class="kw">install.packages</span>(<span class="st">"rgdal"</span>)</span>
<span id="cb158-6"><a href="species-distribution-modeling.html#cb158-6"></a><span class="kw">install.packages</span>(<span class="st">"dismo"</span>)</span>
<span id="cb158-7"><a href="species-distribution-modeling.html#cb158-7"></a><span class="kw">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb158-8"><a href="species-distribution-modeling.html#cb158-8"></a></span>
<span id="cb158-9"><a href="species-distribution-modeling.html#cb158-9"></a><span class="kw">library</span>(conflicted)</span>
<span id="cb158-10"><a href="species-distribution-modeling.html#cb158-10"></a><span class="kw">conflict_prefer</span>(<span class="st">"select"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb158-11"><a href="species-distribution-modeling.html#cb158-11"></a><span class="kw">conflict_prefer</span>(<span class="st">"filter"</span>, <span class="st">"dplyr"</span>)</span></code></pre></div>
<div id="species-distribution-modeling-1" class="section level2">
<h2>
<span class="header-section-number">11.1</span> Species distribution modeling</h2>
<p>In this tutorial we are going to learn the fundamental principles of building an occurrence-based<label for="tufte-sn-51" class="margin-toggle sidenote-number">51</label><input type="checkbox" id="tufte-sn-51" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">51</span> As a side-product in writing this tutorial, I think I might actually learn how to correctly spell ‘occurrence’.</span> species distribution models (SDM).</p>
<p>One of the fundamental questions of ecology is how environmental conditions shape geographic species distributions.</p>
<div id="ques:dist-1" class="question">
<p class="question-begin">
► Question 11.1
</p>
<div class="question-body">
<p>
The concept of an ecological niche has three facets, first it refers to the specific area where an organism lives (comparable to its habitat), second, it describes the role of an organism in an ecoystem, and finally it describes the interrelationship of an organism with all the abiotic and biotic factors it interacts with. Briefly outline what a fundamental and a realized niche is with a focus on how both abiotic and biotic conditions shape a species’ niche.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>We can use this fundamental concept to understand how species distribution models are built. In short, we can identify climatic conditions in locations were a species has been observed (occurs) and use those to build a model of to predict the theoretical distribution of a species by identifying locations that have a high probability of being good habitat based on abiotic predictors. Essentially, species distribution models are mathematical representations of the environmental conditions correlated with observed geographic distribution of a species<label for="tufte-sn-52" class="margin-toggle sidenote-number">52</label><input type="checkbox" id="tufte-sn-52" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">52</span> Of course, more sophisticated version of species distribution models account not only for abiotic parameters but also for biotic factors that could further affect as species actual distribution; though that is a lot more difficult to model!</span>.</p>
<p>One of the advantages of using climatic data as predictors is that we can also use data sets of future climate conditions that have been modeled based on various climate scenarios to understand how species distributions will change as a result of climate-driven shifts in local environmental conditions.</p>
<p>For this tutorial, we will not assess how “good” our generated model is, instead we will focus on the principles of <em>how</em> such a model is built. We will use a very simple model and a general set of climate variables to illustrate the fundamental principles, though currently more sophisticated models are usually used and machine learning is becoming an increasingly important technique. In the end though, the fundamental principles are the same.</p>
<p>Now, let’s load the necessary libraries and get rolling<label for="tufte-sn-53" class="margin-toggle sidenote-number">53</label><input type="checkbox" id="tufte-sn-53" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">53</span> Note: any time you start a new <code>Rsession</code> this is the code chunk you will need to re-run!</span>.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="species-distribution-modeling.html#cb159-1"></a><span class="co"># load libraries</span></span>
<span id="cb159-2"><a href="species-distribution-modeling.html#cb159-2"></a><span class="kw">library</span>(<span class="st">"sp"</span>)</span>
<span id="cb159-3"><a href="species-distribution-modeling.html#cb159-3"></a><span class="kw">library</span>(<span class="st">"raster"</span>)</span>
<span id="cb159-4"><a href="species-distribution-modeling.html#cb159-4"></a><span class="kw">library</span>(<span class="st">"maptools"</span>)</span>
<span id="cb159-5"><a href="species-distribution-modeling.html#cb159-5"></a><span class="kw">library</span>(<span class="st">"rgdal"</span>)</span>
<span id="cb159-6"><a href="species-distribution-modeling.html#cb159-6"></a><span class="kw">library</span>(<span class="st">"dismo"</span>)</span>
<span id="cb159-7"><a href="species-distribution-modeling.html#cb159-7"></a><span class="kw">library</span>(<span class="st">"tidyverse"</span>)</span></code></pre></div>
</div>
<div id="get-occurrence-data" class="section level2">
<h2>
<span class="header-section-number">11.2</span> Get occurrence data</h2>
<p>To learn the fundamental steps of building a SDM, we are going to create species distribution model for the Sasquatch, a large, hairy, bipedal ape-like creature found (or is it?) throughout North America<label for="tufte-sn-54" class="margin-toggle sidenote-number">54</label><input type="checkbox" id="tufte-sn-54" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">54</span> I suppose, technically, since we were venturing into cryptozoology here it is not a species, but rather a cryptid distribution model</span>.</p>
<p>The first think we need for any SDM is a data set documenting species occurrence, i.e. geo-coded observations of a given species in the wild.</p>
<p>Four our purposes, we turn to the Bigfoot Field Researchers Organization (<a href="https://www.bfro.net/">BFRO</a>), founded in 1995 as the “<em>only scientific research organization exploring the Bigfoot/Sasquatch mystery</em>”. You can turn to their website for answers on important <a href="https://www.bfro.net/gdb/show_FAQ.asp?id=405">FAQs</a>, including ‘Do Bigfoot Sasquatch bury their dead?’, ‘Where is the physical evidence?’, ‘Wasn’t this all shown to be a fake?, and ’Why do you want scientists to recognize the Sasquatch as a species? Isn’t it better to just leave them alone?’. Their main focus though is on compiling reports of sightings and investigating them. In other words, they have a database full of geo-coded reported sightings<label for="tufte-sn-55" class="margin-toggle sidenote-number">55</label><input type="checkbox" id="tufte-sn-55" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">55</span> And even better, it has already been downloaded and wrangled and is accessible (with sightings through 2018) right <a href="https://data.world/timothyrenner/bfro-sightings-data">here</a>.</span>.</p>
<p>Let’s read in the data and then we can take a look at the information we can glean from this data set by looking at the column names.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="species-distribution-modeling.html#cb160-1"></a><span class="co"># read data</span></span>
<span id="cb160-2"><a href="species-distribution-modeling.html#cb160-2"></a>occurrence &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">"data/bfro_reports_geocoded.txt"</span>, <span class="dt">delim =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb160-3"><a href="species-distribution-modeling.html#cb160-3"></a></span>
<span id="cb160-4"><a href="species-distribution-modeling.html#cb160-4"></a><span class="co"># take a look at the data</span></span>
<span id="cb160-5"><a href="species-distribution-modeling.html#cb160-5"></a><span class="kw">colnames</span>(occurrence)</span></code></pre></div>
<pre><code>##  [1] "observed"         "location_details" "county"           "state"            "season"           "title"           
##  [7] "latitude"         "longitude"        "date"             "number"           "classification"   "geohash"</code></pre>
<div id="ques:dist-2" class="question">
<p class="question-begin">
► Question 11.2
</p>
<div class="question-body">
<p>
Take a look at the column names and describe what type of information we have available for Sasquatch. Argue which you think will be the most informative to build our species distribution model and discuss which additional information would be helpful to have.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Because we need to be able to identify the exact locations Sasquatch occur, we are going to remove any observations that do not have latitude and longitude information.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="species-distribution-modeling.html#cb162-1"></a>occurrence &lt;-<span class="st"> </span>occurrence <span class="op">%&gt;%</span></span>
<span id="cb162-2"><a href="species-distribution-modeling.html#cb162-2"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(longitude),</span>
<span id="cb162-3"><a href="species-distribution-modeling.html#cb162-3"></a>         <span class="op">!</span><span class="kw">is.na</span>(latitude))</span></code></pre></div>
<div id="ques:dist-3" class="question">
<p class="question-begin">
► Question 11.3
</p>
<div class="question-body">
<p>
Note how many reports we loose through this filtering step. Can you think of an alternative to not removing those reports and and still making them useable for creating our model?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>We have queried only sightings in the United states, one of the first questions we should consider is what their geographic extent is and how they are distributed on a map<label for="tufte-sn-56" class="margin-toggle sidenote-number">56</label><input type="checkbox" id="tufte-sn-56" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">56</span> To keep it simple, we are going to use <code>base R</code> plotting functions instead of our usual <code>ggplot</code> layers</span>.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="species-distribution-modeling.html#cb163-1"></a><span class="co"># get minimum and maximum lat/longs</span></span>
<span id="cb163-2"><a href="species-distribution-modeling.html#cb163-2"></a>max.lat &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">max</span>(occurrence<span class="op">$</span>latitude))</span>
<span id="cb163-3"><a href="species-distribution-modeling.html#cb163-3"></a>min.lat &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">min</span>(occurrence<span class="op">$</span>latitude))</span>
<span id="cb163-4"><a href="species-distribution-modeling.html#cb163-4"></a>max.lon &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">max</span>(occurrence<span class="op">$</span>longitude))</span>
<span id="cb163-5"><a href="species-distribution-modeling.html#cb163-5"></a>min.lon &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">min</span>(occurrence<span class="op">$</span>longitude))</span>
<span id="cb163-6"><a href="species-distribution-modeling.html#cb163-6"></a></span>
<span id="cb163-7"><a href="species-distribution-modeling.html#cb163-7"></a><span class="co"># create an extent object of the range of observations</span></span>
<span id="cb163-8"><a href="species-distribution-modeling.html#cb163-8"></a>geo_range &lt;-<span class="st"> </span><span class="kw">extent</span>(<span class="dt">x =</span> <span class="kw">c</span>(min.lon, max.lon, min.lat, max.lat))</span>
<span id="cb163-9"><a href="species-distribution-modeling.html#cb163-9"></a></span>
<span id="cb163-10"><a href="species-distribution-modeling.html#cb163-10"></a><span class="co"># get base map</span></span>
<span id="cb163-11"><a href="species-distribution-modeling.html#cb163-11"></a><span class="kw">data</span>(wrld_simpl)</span>
<span id="cb163-12"><a href="species-distribution-modeling.html#cb163-12"></a></span>
<span id="cb163-13"><a href="species-distribution-modeling.html#cb163-13"></a><span class="co"># plot the base map</span></span>
<span id="cb163-14"><a href="species-distribution-modeling.html#cb163-14"></a><span class="kw">plot</span>(wrld_simpl, </span>
<span id="cb163-15"><a href="species-distribution-modeling.html#cb163-15"></a>     <span class="dt">xlim =</span> <span class="kw">c</span>(min.lon, max.lon),</span>
<span id="cb163-16"><a href="species-distribution-modeling.html#cb163-16"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(min.lat, max.lat),</span>
<span id="cb163-17"><a href="species-distribution-modeling.html#cb163-17"></a>     <span class="dt">axes =</span> <span class="ot">TRUE</span>, </span>
<span id="cb163-18"><a href="species-distribution-modeling.html#cb163-18"></a>     <span class="dt">col =</span> <span class="st">"grey75"</span>)</span>
<span id="cb163-19"><a href="species-distribution-modeling.html#cb163-19"></a></span>
<span id="cb163-20"><a href="species-distribution-modeling.html#cb163-20"></a><span class="co"># add individual occurrences</span></span>
<span id="cb163-21"><a href="species-distribution-modeling.html#cb163-21"></a><span class="kw">points</span>(<span class="dt">x =</span> occurrence<span class="op">$</span>longitude, </span>
<span id="cb163-22"><a href="species-distribution-modeling.html#cb163-22"></a>       <span class="dt">y =</span> occurrence<span class="op">$</span>latitude, </span>
<span id="cb163-23"><a href="species-distribution-modeling.html#cb163-23"></a>       <span class="dt">col =</span> <span class="st">"darkorange"</span>, </span>
<span id="cb163-24"><a href="species-distribution-modeling.html#cb163-24"></a>       <span class="dt">pch =</span> <span class="dv">20</span>, </span>
<span id="cb163-25"><a href="species-distribution-modeling.html#cb163-25"></a>       <span class="dt">cex =</span> <span class="fl">0.75</span>)</span>
<span id="cb163-26"><a href="species-distribution-modeling.html#cb163-26"></a></span>
<span id="cb163-27"><a href="species-distribution-modeling.html#cb163-27"></a><span class="co"># draw box around figure</span></span>
<span id="cb163-28"><a href="species-distribution-modeling.html#cb163-28"></a><span class="kw">box</span>()</span></code></pre></div>
<div class="figure">
<span id="fig:unnamed-chunk-166"></span>
<p class="caption marginnote shownote">
Figure 11.1: Map of Sasquatch sighting in the United States based on the BFRO database as of 2018.
</p>
<img src="_main_files/figure-html/unnamed-chunk-166-1.png" alt="Map of Sasquatch sighting in the United States based on the BFRO database as of 2018." width="768">
</div>
<div id="ques:dist-4" class="question">
<p class="question-begin">
► Question 11.4
</p>
<div class="question-body">
<p>
Give a brief descriptions of the spatial distribution of the occurrence of Sasquatch in the United States. Note areas where sightings appear to be random, clustered or more dispersed, determine if you think any points should be removed.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:dist-5" class="question">
<p class="question-begin">
► Question 11.5
</p>
<div class="question-body">
<p>
Discuss some possible explanations for the patterns you have observed to determine whether you think this data set is a reasonable representation of the ecological niche of the Sasquatch and can be used to create a species distribution model.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Good catch - those sightings in the middle of the ocean are probably errors in the geo-coding. Further, we don’t know how reliable the data for Alaska is as this data set is based on opportunistic sightings<label for="tufte-sn-57" class="margin-toggle sidenote-number">57</label><input type="checkbox" id="tufte-sn-57" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">57</span> Well, admittedly if you poke around the BFRO website you will find that people do plan expeditions.</span>.</p>
<p>The data for for observations in the lower 48 seems much more reliable, so let’s restrict our data to those observations.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="species-distribution-modeling.html#cb164-1"></a><span class="co"># load and filter data</span></span>
<span id="cb164-2"><a href="species-distribution-modeling.html#cb164-2"></a>occurrence &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">"data/bfro_reports_geocoded.txt"</span>, <span class="dt">delim =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>) <span class="op">%&gt;%</span></span>
<span id="cb164-3"><a href="species-distribution-modeling.html#cb164-3"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(longitude),</span>
<span id="cb164-4"><a href="species-distribution-modeling.html#cb164-4"></a>         <span class="op">!</span><span class="kw">is.na</span>(latitude),</span>
<span id="cb164-5"><a href="species-distribution-modeling.html#cb164-5"></a>         longitude <span class="op">&gt;</span><span class="st"> </span><span class="dv">-130</span>,</span>
<span id="cb164-6"><a href="species-distribution-modeling.html#cb164-6"></a>         latitude <span class="op">&lt;</span><span class="st"> </span><span class="dv">55</span>)</span>
<span id="cb164-7"><a href="species-distribution-modeling.html#cb164-7"></a></span>
<span id="cb164-8"><a href="species-distribution-modeling.html#cb164-8"></a><span class="co"># get minimum and maximum lat/longs</span></span>
<span id="cb164-9"><a href="species-distribution-modeling.html#cb164-9"></a>max.lat &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">max</span>(occurrence<span class="op">$</span>latitude))</span>
<span id="cb164-10"><a href="species-distribution-modeling.html#cb164-10"></a>min.lat &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">min</span>(occurrence<span class="op">$</span>latitude))</span>
<span id="cb164-11"><a href="species-distribution-modeling.html#cb164-11"></a>max.lon &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">max</span>(occurrence<span class="op">$</span>longitude))</span>
<span id="cb164-12"><a href="species-distribution-modeling.html#cb164-12"></a>min.lon &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">min</span>(occurrence<span class="op">$</span>longitude))</span>
<span id="cb164-13"><a href="species-distribution-modeling.html#cb164-13"></a></span>
<span id="cb164-14"><a href="species-distribution-modeling.html#cb164-14"></a><span class="co"># create an extent object</span></span>
<span id="cb164-15"><a href="species-distribution-modeling.html#cb164-15"></a>geo_range &lt;-<span class="st"> </span><span class="kw">extent</span>(<span class="dt">x =</span> <span class="kw">c</span>(min.lon, max.lon, min.lat, max.lat))</span>
<span id="cb164-16"><a href="species-distribution-modeling.html#cb164-16"></a></span>
<span id="cb164-17"><a href="species-distribution-modeling.html#cb164-17"></a><span class="co"># get base map</span></span>
<span id="cb164-18"><a href="species-distribution-modeling.html#cb164-18"></a><span class="kw">data</span>(wrld_simpl)</span>
<span id="cb164-19"><a href="species-distribution-modeling.html#cb164-19"></a></span>
<span id="cb164-20"><a href="species-distribution-modeling.html#cb164-20"></a><span class="co"># plot the base map</span></span>
<span id="cb164-21"><a href="species-distribution-modeling.html#cb164-21"></a><span class="kw">plot</span>(wrld_simpl, </span>
<span id="cb164-22"><a href="species-distribution-modeling.html#cb164-22"></a>     <span class="dt">xlim =</span> <span class="kw">c</span>(min.lon, max.lon),</span>
<span id="cb164-23"><a href="species-distribution-modeling.html#cb164-23"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(min.lat, max.lat),</span>
<span id="cb164-24"><a href="species-distribution-modeling.html#cb164-24"></a>     <span class="dt">axes =</span> <span class="ot">TRUE</span>, </span>
<span id="cb164-25"><a href="species-distribution-modeling.html#cb164-25"></a>     <span class="dt">col =</span> <span class="st">"grey75"</span>)</span>
<span id="cb164-26"><a href="species-distribution-modeling.html#cb164-26"></a></span>
<span id="cb164-27"><a href="species-distribution-modeling.html#cb164-27"></a><span class="co"># add individual occurrences</span></span>
<span id="cb164-28"><a href="species-distribution-modeling.html#cb164-28"></a><span class="kw">points</span>(<span class="dt">x =</span> occurrence<span class="op">$</span>longitude, </span>
<span id="cb164-29"><a href="species-distribution-modeling.html#cb164-29"></a>       <span class="dt">y =</span> occurrence<span class="op">$</span>latitude, </span>
<span id="cb164-30"><a href="species-distribution-modeling.html#cb164-30"></a>       <span class="dt">xlim =</span> <span class="kw">c</span>(min.lon, max.lon),</span>
<span id="cb164-31"><a href="species-distribution-modeling.html#cb164-31"></a>       <span class="dt">ylim =</span> <span class="kw">c</span>(min.lat, max.lat),</span>
<span id="cb164-32"><a href="species-distribution-modeling.html#cb164-32"></a>       <span class="dt">col =</span> <span class="st">"darkorange"</span>, </span>
<span id="cb164-33"><a href="species-distribution-modeling.html#cb164-33"></a>       <span class="dt">pch =</span> <span class="dv">20</span>, </span>
<span id="cb164-34"><a href="species-distribution-modeling.html#cb164-34"></a>       <span class="dt">cex =</span> <span class="fl">0.75</span>)</span>
<span id="cb164-35"><a href="species-distribution-modeling.html#cb164-35"></a></span>
<span id="cb164-36"><a href="species-distribution-modeling.html#cb164-36"></a><span class="co"># draw box around figure</span></span>
<span id="cb164-37"><a href="species-distribution-modeling.html#cb164-37"></a><span class="kw">box</span>()</span></code></pre></div>
<div class="figure">
<span id="fig:unnamed-chunk-167"></span>
<p class="caption marginnote shownote">
Figure 11.2: Map of Sasquatch sighting in the lower 48 states based on the BFRO database as of 2018.
</p>
<img src="_main_files/figure-html/unnamed-chunk-167-1.png" alt="Map of Sasquatch sighting in the lower 48 states based on the BFRO database as of 2018." width="768">
</div>
<p>This should work - on to the next step!</p>
</div>
<div id="get-environmental-data" class="section level2">
<h2>
<span class="header-section-number">11.3</span> Get environmental data</h2>
<p>The next thing we need is a set of predictor variables. Climate is complex and multidimensional, though at its core climate is determined by <a href="https://openoregon.pressbooks.pub/envirobiology/chapter/3-3-terrestrial-biomes/">long-term patterns in mean and variability of temperature and precipitation</a>.</p>
<p>We are going to use the bioclim data set from <a href="https://www.climond.org/BioclimRegistry.aspx#Table1">CliMond</a>. Bioclim variables are commonly used for species distribution modeling as they are based on long-term trends (as opposed to e.g. the exact conditions when the species was observed).</p>
<div id="ques:dist-6" class="question">
<p class="question-begin">
► Question 11.6
</p>
<div class="question-body">
<p>
Look up the descriptions of the <a href="https://www.climond.org/BioclimRegistry.aspx#Table1">bioclim variables</a> and give a brief description of the four abiotic parameters that are included and how they are being parameterized. Argue which you think are most important to describe a species distribution/ecological niche and whether you think overall this data set will help us understand Sasquatch species distribution.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>The data set we are using includes a core set of 19 variables that describe temperature and precipitation, along with an additional 16 variables that describe solar radiation and soil moisture.</p>
<p>I have already downloaded the raster files of the historical (contemporary) bioclim data sets at a resolution of 10’ (minutes) into the data folder. The “historical” data set consists of data from 1961 - 1990 centered on 1975. A raster file is an image file consisting of pixels with data associated with it. In this case, our “pixels” are 10’ x 10’ and depending on the layer the value associated with each pixel is the value for that bioclim value at that geographic location.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="species-distribution-modeling.html#cb165-1"></a><span class="co"># get list of files</span></span>
<span id="cb165-2"><a href="species-distribution-modeling.html#cb165-2"></a>files &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="st">"data/"</span>, <span class="dt">pattern=</span><span class="st">'^CM10_1975H'</span>, <span class="dt">full.names=</span><span class="ot">TRUE</span> )</span>
<span id="cb165-3"><a href="species-distribution-modeling.html#cb165-3"></a></span>
<span id="cb165-4"><a href="species-distribution-modeling.html#cb165-4"></a><span class="co"># import and convert to raster stack</span></span>
<span id="cb165-5"><a href="species-distribution-modeling.html#cb165-5"></a>predictors &lt;-<span class="st"> </span><span class="kw">stack</span>(files)</span></code></pre></div>
<p>We have now created an object that at its core consists of a list where each element is a layer (bioclim variable raster).</p>
<p>Let’s plot the first bioclim variable (Bio01, annual mean temperature).</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="species-distribution-modeling.html#cb166-1"></a><span class="kw">plot</span>(predictors<span class="op">@</span>layers[[<span class="dv">1</span>]])</span></code></pre></div>
<div class="figure">
<span id="fig:unnamed-chunk-169"></span>
<p class="caption marginnote shownote">
Figure 11.3: Global distribution of annual mean temperature (1961 - 1990, centered on 1975).
</p>
<img src="_main_files/figure-html/unnamed-chunk-169-1.png" alt="Global distribution of annual mean temperature (1961 - 1990, centered on 1975)." width="768">
</div>
<p>We see the pattern we would intuitively expect, with temperatures decreasing as you move poleward and being warmest around the poles.</p>
<div id="ques:dist-7" class="question">
<p class="question-begin">
► Question 11.7
</p>
<div class="question-body">
<p>
Choose a range of 5 bioclim variables (this means, don’t just plot the first five variables, chose something more representative of the different parameters represented) and plot each one with a desciption of the variable you are plotting and a 1-2 sentence description of the overall pattern.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="create-species-distribution-model" class="section level2">
<h2>
<span class="header-section-number">11.4</span> Create species distribution model</h2>
<p>Now we have all the information we need to build out model.</p>
<p>The first thing we need to do is extract the values for each bioclim variable at our occurrence points (observations).</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="species-distribution-modeling.html#cb167-1"></a><span class="co"># create df with just xy coordinates</span></span>
<span id="cb167-2"><a href="species-distribution-modeling.html#cb167-2"></a>xy &lt;-<span class="st"> </span>occurrence <span class="op">%&gt;%</span></span>
<span id="cb167-3"><a href="species-distribution-modeling.html#cb167-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(longitude, latitude)</span>
<span id="cb167-4"><a href="species-distribution-modeling.html#cb167-4"></a></span>
<span id="cb167-5"><a href="species-distribution-modeling.html#cb167-5"></a><span class="co"># crop bioclim data to geographic range</span></span>
<span id="cb167-6"><a href="species-distribution-modeling.html#cb167-6"></a>cropped_predictors &lt;-<span class="st"> </span><span class="kw">crop</span>(<span class="dt">x =</span> predictors, <span class="dt">y =</span> geo_range)</span>
<span id="cb167-7"><a href="species-distribution-modeling.html#cb167-7"></a></span>
<span id="cb167-8"><a href="species-distribution-modeling.html#cb167-8"></a><span class="co"># extract values</span></span>
<span id="cb167-9"><a href="species-distribution-modeling.html#cb167-9"></a>presence &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">extract</span>(cropped_predictors, xy)</span></code></pre></div>
<p>Let’s take a quick look at the first few rows and columns of the matrix we just created.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="species-distribution-modeling.html#cb168-1"></a><span class="kw">head</span>(presence[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</span></code></pre></div>
<pre><code>##      CM10_1975H_Bio01_V1.2 CM10_1975H_Bio02_V1.2 CM10_1975H_Bio03_V1.2
## [1,]              6.222110              12.33702             0.3082512
## [2,]              9.368294              12.92369             0.2992488
## [3,]              4.625152              12.45517             0.2672966
## [4,]              9.857348              12.10535             0.3889973
## [5,]              2.780401              14.78537             0.3965279
## [6,]              3.327682              14.78337             0.3814484</code></pre>
<div id="ques:dist-8" class="question">
<p class="question-begin">
► Question 11.8
</p>
<div class="question-body">
<p>
Briefly state what these values represent.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Our next step is to fit a bioclim model to the data set we just generated.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="species-distribution-modeling.html#cb170-1"></a><span class="co"># fit bioclim model</span></span>
<span id="cb170-2"><a href="species-distribution-modeling.html#cb170-2"></a>model.fit &lt;-<span class="st"> </span><span class="kw">bioclim</span>(presence)</span></code></pre></div>
<p>The bioclim model is a classic climate-envelope-model<label for="tufte-sn-58" class="margin-toggle sidenote-number">58</label><input type="checkbox" id="tufte-sn-58" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">58</span> You may remember reading about this in your reading assignments.</span>.</p>
<p>Briefly, the algorithm computes the similarity of locations by comparing the value of each environmental variables being used (our bioclim data set) to a distribution of that values at all locations with known presence<label for="tufte-sn-59" class="margin-toggle sidenote-number">59</label><input type="checkbox" id="tufte-sn-59" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">59</span> Also called the training sites; these are our occurrence points.</span>. The closer that value is to the median (50th percentile), the more suitable that location is assumed to be. Suitability scores are between 0 and 1, with 1 indicating a “perfect suitability”.)</p>
<p>In general, there is no distinction between the tails of the distribution (i.e. the 90th and 10th percentile are equivalent), though in some implementations you can specify those to be treated as distinct. As a result e.g. low levels of precipitation could be limiting but high levels would not be.</p>
<p>Finally, we will use our suitability scores and the bioclim raster data set to generate a predictive map of the Sasquatch species distribution. This means that the algorithm will assign a suitability score to each pixel based on the model and create a new raster layer.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="species-distribution-modeling.html#cb171-1"></a><span class="co"># generate raster with predicted distribution</span></span>
<span id="cb171-2"><a href="species-distribution-modeling.html#cb171-2"></a>prediction &lt;-<span class="st"> </span>dismo<span class="op">::</span><span class="kw">predict</span>(<span class="dt">x =</span> cropped_predictors, </span>
<span id="cb171-3"><a href="species-distribution-modeling.html#cb171-3"></a>                             <span class="dt">object =</span> model.fit,</span>
<span id="cb171-4"><a href="species-distribution-modeling.html#cb171-4"></a>                             <span class="dt">ext =</span> geo_range)</span></code></pre></div>
<p>Let’s plot our species distribution map.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="species-distribution-modeling.html#cb172-1"></a><span class="co"># plot model probabilities</span></span>
<span id="cb172-2"><a href="species-distribution-modeling.html#cb172-2"></a><span class="kw">plot</span>(prediction,</span>
<span id="cb172-3"><a href="species-distribution-modeling.html#cb172-3"></a>     <span class="dt">xlim =</span> <span class="kw">c</span>(min.lon, max.lon),</span>
<span id="cb172-4"><a href="species-distribution-modeling.html#cb172-4"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(min.lat, max.lat),</span>
<span id="cb172-5"><a href="species-distribution-modeling.html#cb172-5"></a>     <span class="dt">axes =</span> <span class="ot">TRUE</span>)</span>
<span id="cb172-6"><a href="species-distribution-modeling.html#cb172-6"></a></span>
<span id="cb172-7"><a href="species-distribution-modeling.html#cb172-7"></a><span class="co"># add map</span></span>
<span id="cb172-8"><a href="species-distribution-modeling.html#cb172-8"></a><span class="kw">plot</span>(wrld_simpl, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">border =</span> <span class="st">"black"</span>)</span>
<span id="cb172-9"><a href="species-distribution-modeling.html#cb172-9"></a></span>
<span id="cb172-10"><a href="species-distribution-modeling.html#cb172-10"></a><span class="co"># draw box around it</span></span>
<span id="cb172-11"><a href="species-distribution-modeling.html#cb172-11"></a><span class="kw">box</span>()</span></code></pre></div>
<div class="figure">
<span id="fig:unnamed-chunk-174"></span>
<p class="caption marginnote shownote">
Figure 11.4: Species distribution model for Sasquatch. Color indicates the probability of encountering Sasquatch in the lower 48 states based on habitat suitability.
</p>
<img src="_main_files/figure-html/unnamed-chunk-174-1.png" alt="Species distribution model for Sasquatch. Color indicates the probability of encountering Sasquatch in the lower 48 states based on habitat suitability." width="768">
</div>
<div id="ques:dist-9" class="question">
<p class="question-begin">
► Question 11.9
</p>
<div class="question-body">
<p>
Give a brief description of the habitat suitability map, including the maximum probabilities. Describe wether this result fits your expectations based on the distribution map of reports we looked at earlier. According to our map, if you were planning a Sasquatch research trip, where would you be headed?
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Our highest habitat suitability values (probability of occurring) seem pretty low. One reason for this is that we used presence-only data.</p>
<div id="ques:dist-10" class="question">
<p class="question-begin">
► Question 11.10
</p>
<div class="question-body">
<p>
The alternative to presence-only models is to have presence-absence data. Discuss how this would improve the models. Argue why you think presence-only data sets are easier to generate.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:dist-11" class="question">
<p class="question-begin">
► Question 11.11
</p>
<div class="question-body">
<p>
A work-around of not having absence data is to generate pseudo-absence data. This is done by generating random points within the geographic range and using those as proxies for absence data. Briefly argue the merits and limitations of such an approach.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="future-climate-change" class="section level2">
<h2>
<span class="header-section-number">11.5</span> Future climate change</h2>
<p>Projections of future climate change are heavily dependent on human activity and the resulting greenhouse gas emissions. Therefore the IPCC’s Assessment Reports contain scenario families that represent projected climate conditions based on emission scenarios resulting from future technological and economic development as defined by each scenario.</p>
<p>Let’s look at how the species distribution map might change in response to a shift in environmental parameters.</p>
<p>In your <code>data</code> directory I have placed a set of bioclim raster files for 2100 generated using the A1B and A2 scenarios. The A1 climate scenarios assume a more integrated world characterized by rapid economic growth, a global population that peaks at 9 billion (2050) and the gradually declines, rapid spread of new/efficient technologies, and a convergent world characterized by extensive worldwide social and cultural interactions. Scenario A1B further assumes a balanced emphasis on fossil and non-fossil fuels. By contrast, A2 scenarios assume a more divided world consisting of independently operating and self-reliant nations and regionally-oriented economic development. The population is assumed to continuously grow. Finally, this scenario is characterized by high emissions.</p>
<p>Let’s start with the <strong>A1 climate scenario</strong> to create our species distribution model.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="species-distribution-modeling.html#cb173-1"></a><span class="co"># get list of files</span></span>
<span id="cb173-2"><a href="species-distribution-modeling.html#cb173-2"></a>files &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="st">"data/"</span>, <span class="dt">pattern=</span><span class="st">'^CM10_2100_A1B'</span>, <span class="dt">full.names=</span><span class="ot">TRUE</span> )</span>
<span id="cb173-3"><a href="species-distribution-modeling.html#cb173-3"></a></span>
<span id="cb173-4"><a href="species-distribution-modeling.html#cb173-4"></a><span class="co"># import and convert to raster stack</span></span>
<span id="cb173-5"><a href="species-distribution-modeling.html#cb173-5"></a>predictors_A1 &lt;-<span class="st"> </span><span class="kw">stack</span>(files)</span></code></pre></div>
<div id="ques:dist-12" class="question">
<p class="question-begin">
► Question 11.12
</p>
<div class="question-body">
<p>
Use the same set of bioclim variables you plotted earlier and plot each one with a desciption of the variable you are plotting and a 1-2 sentence description of the overall pattern and a note as to who this has changed compared to the current (historical) bioclim variables. Consider how you think these changes might affect the species distribution model for Sasquatch.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="species-distribution-modeling.html#cb174-1"></a><span class="kw">plot</span>(predictors_A1<span class="op">@</span>layers[[<span class="dv">1</span>]])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-176-1.png" width="672"></p>
<p>Now let’s fit our model and create predictive map.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="species-distribution-modeling.html#cb175-1"></a><span class="co"># create df with just xy coordinates</span></span>
<span id="cb175-2"><a href="species-distribution-modeling.html#cb175-2"></a>xy &lt;-<span class="st"> </span>occurrence <span class="op">%&gt;%</span></span>
<span id="cb175-3"><a href="species-distribution-modeling.html#cb175-3"></a><span class="st">  </span><span class="kw">select</span>(longitude, latitude)</span>
<span id="cb175-4"><a href="species-distribution-modeling.html#cb175-4"></a></span>
<span id="cb175-5"><a href="species-distribution-modeling.html#cb175-5"></a><span class="co"># crop bioclim data to geographic range</span></span>
<span id="cb175-6"><a href="species-distribution-modeling.html#cb175-6"></a>cropped_predictors &lt;-<span class="st"> </span><span class="kw">crop</span>(<span class="dt">x =</span> predictors_A1, <span class="dt">y =</span> geo_range)</span>
<span id="cb175-7"><a href="species-distribution-modeling.html#cb175-7"></a></span>
<span id="cb175-8"><a href="species-distribution-modeling.html#cb175-8"></a><span class="co"># extract values</span></span>
<span id="cb175-9"><a href="species-distribution-modeling.html#cb175-9"></a>presence &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">extract</span>(cropped_predictors, xy)</span>
<span id="cb175-10"><a href="species-distribution-modeling.html#cb175-10"></a></span>
<span id="cb175-11"><a href="species-distribution-modeling.html#cb175-11"></a><span class="co"># fit the bioclim model</span></span>
<span id="cb175-12"><a href="species-distribution-modeling.html#cb175-12"></a>model.fit &lt;-<span class="st"> </span><span class="kw">bioclim</span>(presence)</span>
<span id="cb175-13"><a href="species-distribution-modeling.html#cb175-13"></a></span>
<span id="cb175-14"><a href="species-distribution-modeling.html#cb175-14"></a><span class="co"># create raster layer of predicted distribution</span></span>
<span id="cb175-15"><a href="species-distribution-modeling.html#cb175-15"></a>prediction &lt;-<span class="st"> </span>dismo<span class="op">::</span><span class="kw">predict</span>(<span class="dt">x =</span> cropped_predictors, </span>
<span id="cb175-16"><a href="species-distribution-modeling.html#cb175-16"></a>                             <span class="dt">object =</span> model.fit,</span>
<span id="cb175-17"><a href="species-distribution-modeling.html#cb175-17"></a>                             <span class="dt">ext =</span> geo_range)</span></code></pre></div>
<p>Finally, let’s plot our species distribution map.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="species-distribution-modeling.html#cb176-1"></a><span class="co"># plot model probabilities</span></span>
<span id="cb176-2"><a href="species-distribution-modeling.html#cb176-2"></a><span class="kw">plot</span>(prediction,</span>
<span id="cb176-3"><a href="species-distribution-modeling.html#cb176-3"></a>     <span class="dt">xlim =</span> <span class="kw">c</span>(min.lon, max.lon),</span>
<span id="cb176-4"><a href="species-distribution-modeling.html#cb176-4"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(min.lat, max.lat),</span>
<span id="cb176-5"><a href="species-distribution-modeling.html#cb176-5"></a>     <span class="dt">axes =</span> <span class="ot">TRUE</span>)</span>
<span id="cb176-6"><a href="species-distribution-modeling.html#cb176-6"></a></span>
<span id="cb176-7"><a href="species-distribution-modeling.html#cb176-7"></a><span class="co"># add map</span></span>
<span id="cb176-8"><a href="species-distribution-modeling.html#cb176-8"></a><span class="kw">plot</span>(wrld_simpl, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">border =</span> <span class="st">"black"</span>)</span>
<span id="cb176-9"><a href="species-distribution-modeling.html#cb176-9"></a></span>
<span id="cb176-10"><a href="species-distribution-modeling.html#cb176-10"></a><span class="co"># draw box around it</span></span>
<span id="cb176-11"><a href="species-distribution-modeling.html#cb176-11"></a><span class="kw">box</span>()</span></code></pre></div>
<div class="figure">
<span id="fig:unnamed-chunk-178"></span>
<p class="caption marginnote shownote">
Figure 11.5: Predicted species distribution for Sasquatch in the lower 48 in 2100 (climate scenario A1B). Color indicates the probability of encountering Sasquatch in the lower 48 states based on habitat suitability.
</p>
<img src="_main_files/figure-html/unnamed-chunk-178-1.png" alt="Predicted species distribution for Sasquatch in the lower 48 in 2100 (climate scenario A1B). Color indicates the probability of encountering Sasquatch in the lower 48 states based on habitat suitability." width="768">
</div>
<div id="ques:dist-13" class="question">
<p class="question-begin">
► Question 11.13
</p>
<div class="question-body">
<p>
Give a brief description of the habitat suitability map, including the maximum probabilities. Describe whether this fit your expectations based on the change in bioclim variables. Describe the shift in habitat suitability relative to our current model.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>How about our A2 climate scenario?.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="species-distribution-modeling.html#cb177-1"></a><span class="co"># get list of files</span></span>
<span id="cb177-2"><a href="species-distribution-modeling.html#cb177-2"></a>files &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="st">"data/"</span>, <span class="dt">pattern=</span><span class="st">'^CM10_2100_A2'</span>, <span class="dt">full.names=</span><span class="ot">TRUE</span> )</span>
<span id="cb177-3"><a href="species-distribution-modeling.html#cb177-3"></a></span>
<span id="cb177-4"><a href="species-distribution-modeling.html#cb177-4"></a><span class="co"># import and convert to raster stack</span></span>
<span id="cb177-5"><a href="species-distribution-modeling.html#cb177-5"></a>predictors_A2 &lt;-<span class="st"> </span><span class="kw">stack</span>(files)</span>
<span id="cb177-6"><a href="species-distribution-modeling.html#cb177-6"></a></span>
<span id="cb177-7"><a href="species-distribution-modeling.html#cb177-7"></a><span class="co"># create df with just xy coordinates</span></span>
<span id="cb177-8"><a href="species-distribution-modeling.html#cb177-8"></a>xy &lt;-<span class="st"> </span>occurrence <span class="op">%&gt;%</span></span>
<span id="cb177-9"><a href="species-distribution-modeling.html#cb177-9"></a><span class="st">  </span><span class="kw">select</span>(longitude, latitude)</span>
<span id="cb177-10"><a href="species-distribution-modeling.html#cb177-10"></a></span>
<span id="cb177-11"><a href="species-distribution-modeling.html#cb177-11"></a><span class="co"># crop bioclim data to geographic range</span></span>
<span id="cb177-12"><a href="species-distribution-modeling.html#cb177-12"></a>cropped_predictors &lt;-<span class="st"> </span><span class="kw">crop</span>(<span class="dt">x =</span> predictors_A2, <span class="dt">y =</span> geo_range)</span>
<span id="cb177-13"><a href="species-distribution-modeling.html#cb177-13"></a></span>
<span id="cb177-14"><a href="species-distribution-modeling.html#cb177-14"></a><span class="co"># extract values</span></span>
<span id="cb177-15"><a href="species-distribution-modeling.html#cb177-15"></a>presence &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">extract</span>(cropped_predictors, xy)</span>
<span id="cb177-16"><a href="species-distribution-modeling.html#cb177-16"></a></span>
<span id="cb177-17"><a href="species-distribution-modeling.html#cb177-17"></a><span class="co"># fit the bioclim model</span></span>
<span id="cb177-18"><a href="species-distribution-modeling.html#cb177-18"></a>model.fit &lt;-<span class="st"> </span><span class="kw">bioclim</span>(presence)</span>
<span id="cb177-19"><a href="species-distribution-modeling.html#cb177-19"></a></span>
<span id="cb177-20"><a href="species-distribution-modeling.html#cb177-20"></a><span class="co"># create raster layer of predicted distribution</span></span>
<span id="cb177-21"><a href="species-distribution-modeling.html#cb177-21"></a>prediction &lt;-<span class="st"> </span>dismo<span class="op">::</span><span class="kw">predict</span>(<span class="dt">x =</span> cropped_predictors, </span>
<span id="cb177-22"><a href="species-distribution-modeling.html#cb177-22"></a>                             <span class="dt">object =</span> model.fit,</span>
<span id="cb177-23"><a href="species-distribution-modeling.html#cb177-23"></a>                             <span class="dt">ext =</span> geo_range)</span>
<span id="cb177-24"><a href="species-distribution-modeling.html#cb177-24"></a></span>
<span id="cb177-25"><a href="species-distribution-modeling.html#cb177-25"></a><span class="co"># plot model probabilities</span></span>
<span id="cb177-26"><a href="species-distribution-modeling.html#cb177-26"></a><span class="kw">plot</span>(prediction,</span>
<span id="cb177-27"><a href="species-distribution-modeling.html#cb177-27"></a>     <span class="dt">xlim =</span> <span class="kw">c</span>(min.lon, max.lon),</span>
<span id="cb177-28"><a href="species-distribution-modeling.html#cb177-28"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(min.lat, max.lat),</span>
<span id="cb177-29"><a href="species-distribution-modeling.html#cb177-29"></a>     <span class="dt">axes =</span> <span class="ot">TRUE</span>)</span>
<span id="cb177-30"><a href="species-distribution-modeling.html#cb177-30"></a></span>
<span id="cb177-31"><a href="species-distribution-modeling.html#cb177-31"></a><span class="co"># add map</span></span>
<span id="cb177-32"><a href="species-distribution-modeling.html#cb177-32"></a><span class="kw">plot</span>(wrld_simpl, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">border =</span> <span class="st">"black"</span>)</span>
<span id="cb177-33"><a href="species-distribution-modeling.html#cb177-33"></a></span>
<span id="cb177-34"><a href="species-distribution-modeling.html#cb177-34"></a><span class="co"># draw box around it</span></span>
<span id="cb177-35"><a href="species-distribution-modeling.html#cb177-35"></a><span class="kw">box</span>()</span></code></pre></div>
<div class="figure">
<span id="fig:unnamed-chunk-179"></span>
<p class="caption marginnote shownote">
Figure 11.6: Predicted species distribution for Sasquatch in the lower 48 in 2100 (climate scenario A2). Color indicates the probability of encountering Sasquatch in the lower 48 states based on habitat suitability.
</p>
<img src="_main_files/figure-html/unnamed-chunk-179-1.png" alt="Predicted species distribution for Sasquatch in the lower 48 in 2100 (climate scenario A2). Color indicates the probability of encountering Sasquatch in the lower 48 states based on habitat suitability." width="768">
</div>
<div id="ques:dist-14" class="question">
<p class="question-begin">
► Question 11.14
</p>
<div class="question-body">
<p>
Briefly compare this model to the previous two. Comment on whether you expected to see greater or smaller difference to the other future climate prediction based on the scenarios that they are based on.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="ques:dist-15" class="question">
<p class="question-begin">
► Question 11.15
</p>
<div class="question-body">
<p>
Discuss whether you think bioclim variables are good models to predict a species’ respone to climate change. In your discussion consider how future bioclim data sets are generated, as well as, whether abiotic conditions along will determine range changes.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="shifting-distributions-impact-species-interactions." class="section level2">
<h2>
<span class="header-section-number">11.6</span> Shifting distributions impact species interactions.</h2>
<div id="ques:dist-16" class="question">
<p class="question-begin">
► Question 11.16
</p>
<div class="question-body">
<p>
Our species distribution models and projected change with shifting environmental conditions are based entirely on changes in abiotic conditions. Briefly discuss the limitations of such an approach and what other factors may impact how species distributions shift over time as the climate changes (Think back to question one and the discussion of fundamental and realized niches).
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Species do not live in isolation their ecological niche merely defined by the sum of the appropriate abiotic conditions, rather they also interact with other species in the ecosystem they inhabit. This means that they will not only be impacted by changes in abiotic conditions but also by changes in biotic conditions. This means that as other species they interact with and rely on for example as prey or as hosts are affected by climate change, species interactions will be affected as a whole and may have indirect effects that alter a species’ distribution and ultimately persistence.</p>
<div id="ques:dist-17" class="question">
<p class="question-begin">
► Question 11.17
</p>
<div class="question-body">
<p>
In class we have discussed how climate change impacting the distribution and phenology of species can lead to an population asynchrony. Give a short explanation of what a population asynchrony is using an example and briefly discuss how this can lead to population decay and local extirpations.
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>One type of relationship that has been well-documented as being susceptible to the development of a population asynchrony is butterfly-host interactions, specifically larval host plants. While adult butterflies drink the nectar of the flowers of the specific plants (sometimes called ‘nectar plants’), caterpillars usually have specific plants they eat (‘host plants’); depending on the species caterpillars may have one specific host or multiple host species (generalists vs specialists). The more specialized the relationship of caterpillar and host plant, the more sensitive a species is to changes in the availability of that plant.</p>
<p>Here is a set of butterfly and corresponding host species:</p>
<table>
<colgroup>
<col width="56%">
<col width="29%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th>Butterfly</th>
<th>approx. # larval hosts</th>
<th>Host Plant</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Eastern Giant Swallowtail (<em>Papilo cresphontes</em>)</td>
<td>10</td>
<td>Prickly Ash (<em>Zanthoxylem americanum</em>)</td>
</tr>
<tr class="even">
<td>California Sister (<em>Adelpha californica</em>)</td>
<td>5</td>
<td>Interior Live Oak (<em>Quercus wislizeni</em>)</td>
</tr>
<tr class="odd">
<td>Great Copper (<em>Lycanena xanthoides</em>)</td>
<td>10</td>
<td>Willow Dock (<em>Rumex salicifolius</em>)</td>
</tr>
</tbody>
</table>
<div id="ques:dist-18" class="question">
<p class="question-begin">
► Question 11.18
</p>
<div class="question-body">
<p>
Describe some factors that could make some of these host interactions being more or less suceptible to the development of a population asynchrony leading to population decay - you can use bullet points to outline factors that would make caterpillar more or less reliable on hosts, and factors that could contribute to a host no longer being in sync with the butterflies).
</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>One effect of climate change could be that changes in the distribution of one or both species would result in less geographic overlap.</p>
<p>In the <code>data</code> directory you will find tab-delimited files corresponding to the six species listed above. They contain occurrence data accessed from <code>iNaturalist</code><label for="tufte-sn-60" class="margin-toggle sidenote-number">60</label><input type="checkbox" id="tufte-sn-60" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">60</span> You may remember iNaturalist as an app-based citizen science project where users upload pictures of species they observe in the wild and experts validate their observations to make the data more reliable.</span>.</p>
<p>For the final component of this lab you will choose one of the butterfly-host species pairs and do the following. You may find it helpful to find a lab/coding bud to work through this final component. You may split the work looking up the species and compiling the necessary code and discuss your results but both of you should write up your own answers and you should make a note in your submission who your lab/coding bud is.</p>
<p>1A. Use the IUCN red list data base to look up the two species. For each list their conservation status and their habitat/geographic range as described on the database (use bullet points to keep it short).</p>
<p>2A. Import the occurrence data for the butterfly species you have chosen and use the historical (current) bioclim data set to generate a species distribution model and plot it on a map.</p>
<p>2B. Import the occurrence data for the corresponding host species you have chosen and use the historical (current) bioclim data set to generate a species distribution model and plot it on a map.</p>
<p>2C. Compare the two species distribution maps to each other and comment how well it matches up with the information you got on habitat/geographic range from the IUCN Redlist database.</p>
<p>3A. Use the occurrence data for the butterfly species and <strong>one</strong> of the future bioclim data sets to generate a species distribution model for 2100 and plot a map of it.</p>
<p>3B. Use the occurrence data for the host species and <strong>the same</strong> future bioclim data set to generate a species distribution model for 2100 and plot a map of it.</p>
<p>3C. State which future bioclim data set you used, compare the two species distribution maps and assess how this biotic interaction could shape the future species distribution of the butterfly species along with changing abiotic conditions. Use your answer to Q17 to evaluate the extent to which this butterfly species could be affected by future climate change; remember to not also just consider changes in distribution but also potential habitat fragmentation.</p>
<p><br><br><br></p>
</div>
<div id="acknowledgments" class="section level2">
<h2>
<span class="header-section-number">11.7</span> Acknowledgments</h2>
<p>Since I’m not the first person to create a lab/tutorial on species distribution modeling, I drew inspiration from various educators, R and data enthusiasts to shape this tutorial, most notably:</p>
<p>Anna L. Carter. November 2017, posting date. Painting turtles: an introduction to species distribution modeling in R. Teaching Issues and Experiments in Ecology, Vol. 13: Practice #1 [online]. <a href="http://tiee.esa.org/vol/v13/issues/data_sets/carter/abstract.html" class="uri">http://tiee.esa.org/vol/v13/issues/data_sets/carter/abstract.html</a></p>
<p>Wendy L. Clement, Kathleen L. Prudic, and Jeffrey C. Oliver. 16 August 2018, posting date. Exploring how climate will impact plant-insect distributions and interactions using open data and informatics. Teaching Issues and Experiments in Ecology, Vol. 14: Experiment #1 [online]. <a href="http://tiee.esa.org/vol/v14/experiments/clement/abstract.html" class="uri">http://tiee.esa.org/vol/v14/experiments/clement/abstract.html</a></p>
<p><a href="https://jcoliver.github.io/learn-r/011-species-distribution-models.html" class="uri">https://jcoliver.github.io/learn-r/011-species-distribution-models.html</a></p>

</div>
</div></body></html>

<p style="text-align: center;">
<a href="biomagnification.html"><button class="btn btn-default">Previous</button></a>
<a href="shark-fin-trade-monitoring.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2020-11-11
</p>
</div>
</div>



</body>
</html>
